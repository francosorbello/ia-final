---
title: "R Notebook"
output: html_notebook
---

Paso 1: importar informacion y librer√≠as
```{r}
library("recommenderlab")
library(dplyr)
library("ggplot2")
library(readr)
ratings <- read.csv("scrappers/ratings.csv")
game_info <- read.csv("scrappers/games.csv")
```

Transformo game_info en una matriz numerica

```{r}
genres <- read.csv("game_genres.csv")
genres_rec <- Recommender(train_set,method = "IBCF")
#convierto la matriz de recomendacion obtenida en un objeto matrix
item_genres <- as(genres_rec@model$sim,"matrix")
dim(item_genres)
```


Paso 2: convierto a RealRatingMatrix para poder trabajar con recommenderlab
```{r}
ratings_realMatrix <- ratings %>% as("realRatingMatrix")
#normalizo
#ratings_realMatrix %>% normalize %>% getRatings %>% hist(main = "Rating normalizados por usuario")
#elimino users con menos de 10 reviews
ratings10 <-ratings_realMatrix[rowCounts(ratings_realMatrix) >= 10]

#ratings10@data[1:5,1:4] #esta linea muestra los primeros 5 users y sus reviews de los primeros 4 juegos
```
Paso 3: Separacion de datos en training set y test set

```{r}
#selecciono elementos al azar. La variable prob indica que uso el 80% para training y el 20% para testing
set_separator <- sample(x = c(TRUE,FALSE),size = nrow(ratings10),replace = TRUE,prob = c(0.8,0.2))

train_set <- ratings10[set_separator,]
test_set <- ratings10[!set_separator,]
train_set
```

Paso 4: creo matriz de recomendacion utilizando IBCF

```{r}
rec <- Recommender(train_set,method = "IBCF")
#convierto la matriz de recomendacion obtenida en un objeto matrix
item_ratings <- as(rec@model$sim,"matrix")
dim(item_ratings)
```

Paso 5: creo matriz de similitud para las propiedades de los items

TODO: encontrar manera de calcular la distancia entre distintos juegos.
Una posibilidad es crear una nueva matriz que para cada categoria indique si el juego pertenece a ella o no(mediante 1 y 0) y luego calcular la distancia sumando los resultados de todas las categorias. Ademas deberia hacer lo mismo con las plataformas


Distancia de levenstein

```{r}
#por ahora remuevo la plataforma para solo evaluar por genero
game_info2 <- select(game_info,-gameId, -platforms)
```

